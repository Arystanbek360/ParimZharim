## Отмена заказа через API

### Описание

**Цель**: Тестирование функциональности отмены заказа через API.

Проверка процесса отмены заказа с различными условиями и параметрами, включая валидацию доступа и статуса заказа, а также корректное управление ошибками.

### Предусловия и необходимые инструменты

- Авторизованный клиент с профилем клиента и активными заказами.
- Доступ к API по адресу `/api/orders/cancel`.
- Токен авторизованного клиента.

### Тестовые данные

- Токен клиента с заказами: [токен клиента с заказами].
- Неверный или отсутствующий токен: [неверный токен].
- Существующий заказ ID, принадлежащий клиенту: 123.
- Существующий заказ ID, не принадлежащий клиенту: 456.
- Несуществующий заказ ID: 999.
- Заказ ID в статусе, который не разрешает отмену (например, уже отмененный или завершенный): 789.

### Позитивные кейсы

#### Шаг 1:
Отправить GET-запрос на `/api/orders/cancel?order_id=123` с токеном клиента.
**Ожидаемый результат**: Заказ успешно отменен, статус-код 204.

### Негативные кейсы

#### Шаг 1:
Отправить GET-запрос на `/api/orders/cancel?order_id=123` без токена или с неверным токеном.
**Ожидаемый результат**: Возвращается статус-код 401 с сообщением об ошибке "Unauthorized".

#### Шаг 2:
Отправить GET-запрос на `/api/orders/cancel?order_id=999` с токеном клиента.
**Ожидаемый результат**: Возвращается статус-код 404 с сообщением об ошибке "Не найден заказ с идентификатором 84".

#### Шаг 3:
Отправить GET-запрос на `/api/orders/cancel?order_id=456` с токеном клиента.
**Ожидаемый результат**: Возвращается статус-код 403 с сообщением об ошибке "Order does not belong to this customer".

#### Шаг 4:
Отправить GET-запрос на `/api/orders/cancel?order_id=789` с токеном клиента.
**Ожидаемый результат**: Возвращается статус-код 409 с сообщением об ошибке "Application Error: Невозможно перевести в заказ в статус 'Запрошена отмена' для текущего статуса  'Отменен'".

#### Шаг 5:
Отправить GET-запрос на `/api/orders/cancel` с токеном клиента, но без указания `order_id`.
**Ожидаемый результат**: Возвращается статус-код 400 с сообщением об ошибке "Order ID is required".

### Примеры запросов и ответов для негативных кейсов

#### Без токена или с неверным токеном:
GET `/api/orders/cancel?order_id=123`
Headers:
```
Authorization: Bearer [неверный токен]
```
**Ожидаемый результат**:
```json
{
  "error": "Unauthorized"
}
```

#### Заказ не принадлежит клиенту:
GET `/api/orders/cancel?order_id=456`
Headers:
```
Authorization: Bearer [токен клиента]
```
**Ожидаемый результат**:
```json
{
    "message": "Order does not belong to this customer",
    "status_code": 403
}
```

#### Заказ в недопустимом статусе:
GET `/api/orders/cancel?order_id=789`
Headers:
```
Authorization: Bearer [токен клиента]
```
**Ожидаемый результат**:
```json
{
    "message": "Application Error: Невозможно перевести в заказ в статус 'Запрошена отмена' для текущего статуса  'Отменен'",
    "status_code": 409
}
```

### Постусловия

- Убедиться, что клиент может повторно авторизоваться при необходимости.
- Проверить, что данные заказа корректно обновляются в базе данных при успешной отмене.

### Замечания/Примечания

- Проверить корректность работы авторизации через токен.
- Убедиться, что система корректно обрабатывает различные статусы заказов и возвращает соответствующие ошибки при попытках недопустимой отмены.
- Проверить, что при отсутствии `order_id` возвращается ошибка 400.
